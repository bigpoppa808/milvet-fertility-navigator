import{j as e}from"./ui-Db5bRdDi.js";import{r as s}from"./router-BKJR1vSY.js";import{L as a,B as r,C as t,a as i,b as n,c as l,d as o,P as c,p as d,e as m,f as x}from"./charts-DnRkSF-E.js";import{u,s as h}from"./index-Czm5Afhy.js";import{m as g}from"./animations-VixCDSC1.js";import{F as p}from"./ChartBarIcon-N6d8svoY.js";import{F as b}from"./UsersIcon-DrhsMAo2.js";import{F as y,a as f}from"./ShareIcon-1kXcEFym.js";import{F as j}from"./CurrencyDollarIcon-Dr9DYLe_.js";import{F as v}from"./ClockIcon-31jjkHyt.js";import"./vendor-D1VVuCdH.js";import"./supabase-BFTN-V_O.js";import"./query-wqeBDHbW.js";function N({title:e,titleId:a,...r},t){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},r),e?s.createElement("title",{id:a},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18"}))}const w=s.forwardRef(N);function S({title:e,titleId:a,...r},t){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},r),e?s.createElement("title",{id:a},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M17.593 3.322c1.1.128 1.907 1.077 1.907 2.185V21L12 17.25 4.5 21V5.507c0-1.108.806-2.057 1.907-2.185a48.507 48.507 0 0 1 11.186 0Z"}))}const C=s.forwardRef(S);function k({title:e,titleId:a,...r},t){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},r),e?s.createElement("title",{id:a},e):null,s.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 15.75V18m-7.5-6.75h.008v.008H8.25v-.008Zm0 2.25h.008v.008H8.25V13.5Zm0 2.25h.008v.008H8.25v-.008Zm0 2.25h.008v.008H8.25V18Zm2.498-6.75h.007v.008h-.007v-.008Zm0 2.25h.007v.008h-.007V13.5Zm0 2.25h.007v.008h-.007v-.008Zm0 2.25h.007v.008h-.007V18Zm2.504-6.75h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V13.5Zm0 2.25h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V18Zm2.498-6.75h.008v.008h-.008v-.008Zm0 2.25h.008v.008h-.008V13.5ZM8.25 6h7.5v2.25h-7.5V6ZM12 2.25c-1.892 0-3.758.11-5.593.322C5.307 2.7 4.5 3.65 4.5 4.757V19.5a2.25 2.25 0 0 0 2.25 2.25h10.5a2.25 2.25 0 0 0 2.25-2.25V4.757c0-1.108-.806-2.057-1.907-2.185A48.507 48.507 0 0 0 12 2.25Z"}))}const I=s.forwardRef(k);t.register(i,n,l,o,c,d,m,x);const M=["IVF Coverage Expansion","Fertility Preservation Program","Grant Funding Increase","Travel Allowance Program","Comprehensive Coverage"],R=["Immediate (6 months)","Phased (1 year)","Gradual (2 years)","Long-term (3+ years)"];function T(){const[t,i]=s.useState([]),[n,l]=s.useState(!0),[o,c]=s.useState(!1),[d,m]=s.useState({policyType:"IVF Coverage Expansion",implementation:"Phased (1 year)",coverage:80,costSharing:20,eligibility:["Active Duty + Reserves"],timeframe:5,population:1e5}),[x,N]=s.useState(null),[S,k]=s.useState(!1),{user:T}=u();s.useEffect(()=>{E()},[]);const E=async()=>{try{const{data:e,error:s}=await h.from("simulation_scenarios").select("*").eq("is_public",!0).order("usage_count",{ascending:!1}).limit(10);s?console.error("Error fetching scenarios:",s):i(e||[])}catch(e){console.error("Error:",e)}finally{l(!1)}},D=async e=>{if(T)try{await h.from("simulation_scenarios").insert({name:`${d.policyType} Simulation`,description:`Simulated ${d.policyType} with ${d.coverage}% coverage`,scenario_type:"policy_impact",parameters:d,created_by:T.id,is_public:!1})}catch(s){console.error("Error saving scenario:",s)}},Z=x?{labels:x.monteCarloData?.timeSeriesData?["Current State",...x.monteCarloData.timeSeriesData.map(e=>`Year ${e.year}`)]:["Current State","Year 1","Year 2","Year 3","Year 5"],datasets:[{label:"Access to Care (%)",data:x.monteCarloData?.timeSeriesData?[35,...x.monteCarloData.timeSeriesData.map(e=>e.meanAccess)]:[35,45,55,65,35+x.accessIncrease],borderColor:"rgb(59, 130, 246)",backgroundColor:"rgba(59, 130, 246, 0.1)",tension:.4},{label:"Cumulative Cost ($M)",data:x.monteCarloData?.timeSeriesData?[0,...x.monteCarloData.timeSeriesData.map(e=>e.meanCost/1e6)]:[0,2,5,8,x.costSavings/1e6],borderColor:"rgb(16, 185, 129)",backgroundColor:"rgba(16, 185, 129, 0.1)",tension:.4}]}:null,V=x?{labels:["Access Increase","Beneficiaries Served","Wait Time Reduction","Readiness Impact"],datasets:[{label:"Impact Metrics",data:[x.accessIncrease,x.beneficiariesServed/1e3,x.waitTimeReduction,x.readinessImpact],backgroundColor:["rgba(59, 130, 246, 0.8)","rgba(16, 185, 129, 0.8)","rgba(245, 158, 11, 0.8)","rgba(139, 92, 246, 0.8)"]}]}:null;return n?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading policy simulator..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 sm:text-4xl",children:"Military Fertility Policy Impact Simulator"}),e.jsx("p",{className:"mt-4 text-lg text-gray-600 max-w-3xl mx-auto",children:"Model the impact of different fertility policy scenarios on military families. Use Monte Carlo simulations to understand potential outcomes and make data-driven advocacy."})]}),e.jsx("div",{className:"mt-8 flex justify-center",children:e.jsxs("button",{onClick:()=>c(!0),className:"inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[e.jsx(I,{className:"h-5 w-5 mr-2"}),"Start New Simulation"]})})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:o?e.jsxs("div",{className:"grid gap-8 lg:grid-cols-3",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6 sticky top-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Simulation Parameters"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Policy Type"}),e.jsx("select",{value:d.policyType,onChange:e=>m(s=>({...s,policyType:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:M.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Implementation Timeline"}),e.jsx("select",{value:d.implementation,onChange:e=>m(s=>({...s,implementation:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:R.map(s=>e.jsx("option",{value:s,children:s},s))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Coverage Level: ",d.coverage,"%"]}),e.jsx("input",{type:"range",min:"0",max:"100",value:d.coverage,onChange:e=>m(s=>({...s,coverage:parseInt(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Cost Sharing: ",d.costSharing,"%"]}),e.jsx("input",{type:"range",min:"0",max:"50",value:d.costSharing,onChange:e=>m(s=>({...s,costSharing:parseInt(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Target Population"}),e.jsx("input",{type:"number",value:d.population,onChange:e=>m(s=>({...s,population:parseInt(e.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"100000"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Analysis Timeframe: ",d.timeframe," years"]}),e.jsx("input",{type:"range",min:"1",max:"10",value:d.timeframe,onChange:e=>m(s=>({...s,timeframe:parseInt(e.target.value)})),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer"})]})]}),e.jsxs("div",{className:"mt-8 space-y-3",children:[e.jsxs("button",{onClick:async()=>{k(!0);try{console.log("Running Monte Carlo simulation with parameters:",d);const{data:e,error:s}=await h.functions.invoke("monte-carlo-simulation",{body:{policyType:d.policyType,implementation:d.implementation,coverage:d.coverage,costSharing:d.costSharing,eligibility:d.eligibility,timeframe:d.timeframe,population:d.population,iterations:5e3}});if(s)throw console.error("Monte Carlo simulation error:",s),new Error("Simulation failed");if(!e?.data)throw new Error("No simulation results received");const a=e.data;console.log("Received Monte Carlo results:",a);const r={accessIncrease:Math.round(a.summary.accessIncrease.mean),costSavings:Math.round(a.summary.totalCost.mean),beneficiariesServed:Math.round(a.summary.beneficiariesServed.mean),waitTimeReduction:Math.round(a.summary.waitTimeReduction.mean),economicImpact:Math.round(1.5*a.summary.totalCost.mean),readinessImpact:Math.round(a.summary.readinessImpact.mean),monteCarloData:a};N(r),T&&await D(r)}catch(e){console.error("Simulation error:",e),alert("Simulation failed. Please try again with different parameters.")}finally{k(!1)}},disabled:S,className:"w-full flex items-center justify-center px-4 py-3 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:[S?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):e.jsx(y,{className:"h-4 w-4 mr-2"}),S?"Running Simulation...":"Run Simulation"]}),e.jsx("button",{onClick:()=>c(!1),className:"w-full px-4 py-3 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:"Back to Scenarios"})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:x?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[e.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(w,{className:"h-8 w-8 text-green-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Access Increase"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[x.accessIncrease,"%"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(j,{className:"h-8 w-8 text-blue-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Cost Savings"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:["$",(x.costSavings/1e6).toFixed(1),"M"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(b,{className:"h-8 w-8 text-purple-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Beneficiaries"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[(x.beneficiariesServed/1e3).toFixed(1),"K"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(v,{className:"h-8 w-8 text-yellow-500"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Wait Reduction"}),e.jsxs("p",{className:"text-2xl font-bold text-gray-900",children:[x.waitTimeReduction,"%"]})]})]})})]}),e.jsxs("div",{className:"grid gap-6 lg:grid-cols-2",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Timeline Impact"}),Z&&e.jsx(a,{data:Z,options:{responsive:!0}})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Impact Metrics"}),V&&e.jsx(r,{data:V,options:{responsive:!0}})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Simulation Summary"}),e.jsxs("div",{className:"prose max-w-none text-gray-700",children:[e.jsxs("p",{children:["The simulation of ",e.jsx("strong",{children:d.policyType})," with ",e.jsxs("strong",{children:[d.coverage,"% coverage"]}),"shows significant potential benefits for military families. Over a ",e.jsxs("strong",{children:[d.timeframe,"-year period"]}),", this policy could increase access to fertility care by ",e.jsxs("strong",{children:[x.accessIncrease,"%"]})," and serve approximately ",e.jsx("strong",{children:x.beneficiariesServed.toLocaleString()})," beneficiaries."]}),e.jsxs("p",{children:["The policy is projected to generate ",e.jsxs("strong",{children:["$",(x.costSavings/1e6).toFixed(1)," million"]})," in cost savings and reduce wait times by ",e.jsxs("strong",{children:[x.waitTimeReduction,"%"]}),". Military readiness could improve by ",e.jsxs("strong",{children:[x.readinessImpact,"%"]})," due to reduced stress and improved family planning options."]})]}),e.jsxs("div",{className:"mt-6 flex space-x-3",children:[e.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700",children:[e.jsx(f,{className:"h-4 w-4 mr-2"}),"Share Results"]}),e.jsxs("button",{className:"inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:[e.jsx(C,{className:"h-4 w-4 mr-2"}),"Save Scenario"]})]})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-12 text-center",children:[e.jsx(p,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Ready to Simulate"}),e.jsx("p",{className:"text-gray-600",children:'Configure your simulation parameters and click "Run Simulation" to see the projected impact.'})]})})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Popular Simulation Scenarios"}),e.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:t.slice(0,6).map((s,a)=>e.jsxs(g.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*a},className:"bg-white rounded-lg shadow border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>c(!0),children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s.name}),e.jsx(p,{className:"h-5 w-5 text-blue-500"})]}),s.description&&e.jsx("p",{className:"text-gray-600 mb-4",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(b,{className:"h-4 w-4 mr-1"}),s.usage_count," runs"]}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString()})]})]},s.id))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-8",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"How to Use the Policy Simulator"}),e.jsxs("div",{className:"grid gap-8 md:grid-cols-3",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(I,{className:"h-8 w-8 text-blue-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Configure Parameters"}),e.jsx("p",{className:"text-gray-600",children:"Set policy type, coverage levels, eligibility criteria, and implementation timeline."})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(y,{className:"h-8 w-8 text-green-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Run Simulation"}),e.jsx("p",{className:"text-gray-600",children:"Execute Monte Carlo modeling to generate impact predictions and outcome scenarios."})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(p,{className:"h-8 w-8 text-purple-600"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Analyze Results"}),e.jsx("p",{className:"text-gray-600",children:"Review detailed analytics, charts, and export data for advocacy and policy proposals."})]})]})]})]})})]})}export{T as PolicySimulatorPage};
