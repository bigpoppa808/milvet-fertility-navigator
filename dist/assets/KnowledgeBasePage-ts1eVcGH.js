import{j as e}from"./ui-Db5bRdDi.js";import{r as s}from"./router-BKJR1vSY.js";import{s as t,b as a}from"./index-Czm5Afhy.js";import{m as r}from"./animations-VixCDSC1.js";import{F as l}from"./DocumentTextIcon-C2wc7GEG.js";import{F as i}from"./TagIcon-DC8QP4rD.js";import{F as n}from"./ArrowTopRightOnSquareIcon-9OT3nt5t.js";import"./vendor-D1VVuCdH.js";import"./supabase-BFTN-V_O.js";import"./query-wqeBDHbW.js";const o=["All Categories","TRICARE Benefits","VA Benefits","Clinical Information","Statistics and Research","Legislation","Funding"];function c(){const[c,d]=s.useState([]),[m,x]=s.useState([]),[h,g]=s.useState(!0),[u,p]=s.useState(!1),[f,y]=s.useState(""),[b,j]=s.useState("All Categories"),[N,v]=s.useState(null);s.useEffect(()=>{w()},[]),s.useEffect(()=>{(async()=>{await C()})()},[c,f,b]);const w=async()=>{try{const{data:e,error:s}=await t.from("knowledge_base").select("*").order("created_at",{ascending:!1});s?console.error("Error fetching knowledge items:",s):d(e||[])}catch(e){console.error("Error:",e)}finally{g(!1)}},C=async()=>{let e=c;if("All Categories"!==b&&(e=e.filter(e=>e.category===b)),f.trim()){p(!0);try{console.log("Performing AI search for:",f);const{data:s,error:a}=await t.functions.invoke("ai-search",{body:{query:f,limit:20}});if(a)console.error("AI search error:",a),A(e);else if(s?.data?.results){console.log("AI search results:",s.data.results);let e=s.data.results;"All Categories"!==b&&(e=e.filter(e=>e.category===b)),x(e)}else A(e)}catch(s){console.error("AI search error:",s),A(e)}finally{p(!1)}}else x(e)},A=e=>{const s=f.toLowerCase(),t=e.filter(e=>e.title.toLowerCase().includes(s)||e.content.toLowerCase().includes(s)||e.summary&&e.summary.toLowerCase().includes(s)||e.tags&&e.tags.some(e=>e.toLowerCase().includes(s)));x(t)},k=(s,t)=>{if(!t.trim())return s;const a=new RegExp(`(${t})`,"gi");return s.split(a).map((s,t)=>a.test(s)?e.jsx("mark",{className:"bg-yellow-200 px-1 rounded",children:s},t):s)};return h?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading knowledge base..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 sm:text-4xl",children:"Fertility Knowledge Base"}),e.jsx("p",{className:"mt-4 text-lg text-gray-600 max-w-3xl mx-auto",children:"Comprehensive, searchable database of fertility information specifically for military families. Find answers to your questions about TRICARE benefits, VA coverage, treatments, and more."})]}),e.jsxs("div",{className:"mt-8 max-w-4xl mx-auto",children:[e.jsxs("div",{className:"relative",children:[u?e.jsx("div",{className:"absolute left-3 top-1/2 transform -translate-y-1/2",children:e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-blue-600"})}):e.jsx(a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"AI-powered search: fertility information, benefits, procedures...",value:f,onChange:e=>y(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",disabled:u})]}),e.jsx("div",{className:"mt-4 flex flex-wrap gap-2",children:o.map(s=>e.jsx("button",{onClick:()=>j(s),className:"px-4 py-2 rounded-full text-sm font-medium transition-colors "+(b===s?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:s},s))})]})]})}),e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:e.jsxs("div",{className:"flex gap-8",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Found ",m.length," article",1!==m.length?"s":"",f.trim()&&!u&&e.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-blue-100 text-blue-800",children:"ðŸ¤– AI Search"})]}),u&&e.jsxs("div",{className:"text-sm text-blue-600 flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600 mr-2"}),"Searching with AI..."]})]}),e.jsxs("div",{className:"space-y-6",children:[m.map((s,t)=>e.jsx(r.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1*t},className:"bg-white rounded-lg shadow border border-gray-200 p-6 hover:shadow-md transition-shadow cursor-pointer",onClick:()=>v(s),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:k(s.title,f)}),s.summary&&e.jsx("p",{className:"text-gray-600 mb-3",children:k(s.summary,f)}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[s.category&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:s.category}),s.source_organization&&e.jsxs("span",{className:"flex items-center",children:[e.jsx(l,{className:"h-4 w-4 mr-1"}),s.source_organization]}),e.jsx("span",{children:new Date(s.created_at).toLocaleDateString()})]}),s.tags&&s.tags.length>0&&e.jsxs("div",{className:"mt-3 flex flex-wrap gap-1",children:[s.tags.slice(0,5).map(s=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium bg-gray-100 text-gray-600",children:[e.jsx(i,{className:"h-3 w-3 mr-1"}),s]},s)),s.tags.length>5&&e.jsxs("span",{className:"text-xs text-gray-500",children:["+",s.tags.length-5," more"]})]})]}),e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsx("button",{className:"text-blue-600 hover:text-blue-500",children:e.jsx(l,{className:"h-5 w-5"})})})]})},s.id)),0===m.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(l,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No articles found"}),e.jsx("p",{className:"text-gray-600",children:"Try adjusting your search terms or selecting a different category."})]})]})]}),e.jsxs("div",{className:"w-80 flex-shrink-0",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Featured Topics"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-blue-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"TRICARE Fertility Coverage"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Understanding what fertility treatments are covered under TRICARE."})]}),e.jsxs("div",{className:"p-3 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-900",children:"VA Benefits for Veterans"}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Comprehensive fertility benefits for service-connected conditions."})]}),e.jsxs("div",{className:"p-3 bg-purple-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-purple-900",children:"Latest Legislation"}),e.jsx("p",{className:"text-sm text-purple-700 mt-1",children:"Recent updates to military fertility legislation and policies."})]})]})]}),e.jsxs("div",{className:"mt-6 bg-white rounded-lg shadow border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Check Eligibility"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Find what benefits you qualify for"})]}),e.jsxs("button",{className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Find Funding"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Explore grants and assistance programs"})]}),e.jsxs("button",{className:"w-full text-left p-3 rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[e.jsx("div",{className:"font-medium text-gray-900",children:"Connect with Community"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Join discussions and support groups"})]})]})]})]})]})}),N&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs(r.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-lg shadow-xl max-w-4xl max-h-[80vh] overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:N.title}),e.jsxs("button",{onClick:()=>v(null),className:"text-gray-400 hover:text-gray-600",children:[e.jsx("span",{className:"sr-only",children:"Close"}),e.jsx("svg",{className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})]})]}),e.jsxs("div",{className:"mt-2 flex items-center space-x-4 text-sm text-gray-500",children:[N.category&&e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:N.category}),N.source_organization&&e.jsx("span",{children:N.source_organization}),e.jsx("span",{children:new Date(N.created_at).toLocaleDateString()})]})]}),e.jsxs("div",{className:"p-6 overflow-y-auto max-h-96",children:[e.jsx("div",{className:"prose max-w-none",children:N.content.split("\n\n").map((s,t)=>e.jsx("p",{className:"mb-4 text-gray-700 leading-relaxed",children:s},t))}),N.source_url&&e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("a",{href:N.source_url,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-blue-600 hover:text-blue-500",children:[e.jsx(n,{className:"h-4 w-4 mr-2"}),"View original source"]})})]})]})})]})}export{c as KnowledgeBasePage};
